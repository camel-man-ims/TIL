# 3장 Ip Addressing

## 1. 3계층 개요

* 2계층
  * 2계층의 역할은 아래와 같다.
    * 같은 세그먼트 내 데이터 송수신
    * 네트워크 내 인접기기간 데이터 송수신
    * 라우터 내 통신
  * 이런 2계층은 1계층에서 신호가 제대로 운반됐다는 전제하에서 데이터를 송수신하는 역할을 한다.
    * 즉 신호의 운반처리는 1계층만 처리하게 된다.

* 3계층
  * 2계층이 네트워크 **내** 데이터 송수신이라면, 3계층은 네트워크 **간** 데이터 송수신이다.

* 인터넷(Internet)
  * 네트워크 간에서 데이터 송수신을 지칭한다.
  * www.를 접속해서 볼 수 있는 인터넷(INTERNET, The internet 등)은 고유명사의 인터넷이다. 3계층에서 말하는 인터넷과는 다르다.

* 3계층의 특징
  * Addressing
    * 주소
      * 주소는 논리주소와 물리주소가 있다.
      * 둘을 가르는 기준은 위치정보의 포함 여부이다.
      * MAC주소는 물리주소인데, 48비트 중 앞 24bit에는 벤더코드, 뒤 24bit에는 식별코드가 들어간다.
        * 즉, 위치정보에 대한 data는 들어가지 않는다.
      * 논리주소에 대한 위치정보는 어디 네트워크의 어디 컴퓨터라는 정보의 조합으로 구성된다.
  * Routing
    * 수신처에 연결돼 있는 회선을 선택해서,해당 회선에 패킷을 송신하는 것
    * 즉, 어느 경로로 수신처 네트워크에 데이터를 송신할 것인지 결정하는 것을 의미한다.

* IPv4, IPv6
  * IPv4와 IPv6는 호환성이 없다.
    * IPv4, IPv6를 둘다 사용할 수 있는 컴퓨터도 존재한다.
    * 호환성이 없다는 말은 어느 한 쪽만 사용해야 된다는 것이 아니라, IPv4만 사용하는 컴퓨터는 IPv6를 사용하는 컴퓨터와 데이터 송수신을 할 수 없다는 이야기다.

* IP Datagram
  * IP Header + PDU = IP Datagram
  * 3계층에서는 4계층의 PDU에 3계층의 IP Header가 붙는다.
  * IP 헤더에는 여러 값이 붙는데, 그 중 가장 중요한 것이 송신처와 수신처의 IP 주소이다.

## 2. IP 주소

* 계층형 주소
  * 논리주소는 기본적으로 계층형 주소를 갖는다.
    * 서울시 노원구 공릉동과 비슷한 논리라고 생각하면 될 것 같다.
  * MAC과 같은 물리주소는 위치정보와 상관없이 고정적인 값을 갖는 데 반면, 네트워크의 논리주소는 관리자에 의해 유동적으로 바뀔 수 있다.
  
* 유니캐스트, 멀티캐스트, 브로드 캐스트 주소
  * 유니캐스트 주소는 같은 네트워크 내에서 유일해야 한다.
    * 즉, 다른 네트워크라면 같은 유니캐스트 주소를 가져도 상관없다.
    * 왜냐하면 논리주소는 네트워크 번호 + 컴퓨터 번호의 조합으로 이루어지기 때문이다.

* IPv4
  * IPv4는 8비트의 옥텟 4개, 32비트로 이루어져있다.
    * 32비트를 4개로 나눈 8비트 하나의 단위를 옥텟이라고 한다.
    * 옥텟은 8비트를 10진수로 표기한다.
      * ex) 192.0.8.5
  * IPv4는 네트워크 번호와 컴퓨터 번호를 표시한다.

* Classfull addressing
  * 네트워크 주소를 클래스로 나누어서 IP 주소를 할당하는 방식이다.
  * 클래스에는 A,B,C,D,E 클래스가 존재한다.
    * A클래스는 네트워크 8비트 + 컴퓨터 번호 24비트
    * B클래스는 16, 16
    * C클래스는 24, 8 로 이루어진다. 
  * A클래스는 제1옥텟이 0으로, B클래스는 10, C클래스는 110으로 시작한다.
    * A는 앞에 0으로 시작하므로 앞 하나 빼고, B는 10으로 시작하므로 앞 2개빼고, C는 110으로 시작하니까 앞 3개빼고
      * A -> 2^7
      * B -> 2^14
      * C -> 2^21 
      * 이 된다.
    * D,E는 보통 할당하지 않는다.

| class | 규모 | 네트워크 수 | 1개의 네트워크가 가진 IP 수 | 네트워크 번호 |
| ----- | ---- | ----------- | --------------------------- | --------- |
| A | 국가, 대기업 | 2^7, 128 | 1600만 | 0xxxxxxx |
| B | 중견 기업 | 2^14, 약16000 | 2^16, 65536 | 10xxxxxx... 16자리 |
| C | 중~소규모 기업 | 2^21, 약 209만 | 2^8, 256 | 110xxx... 24자리 |
| D | 멀티캐스트 용 | - | - | - |
| E | 연구용 | - | - | - |

* 전화번호
  * 서울만 02이고, 대전같은 경우 042로 시작한다.
    * 즉 3자리이다.
  * 전화번호는 10자리를 할당할 수 있는데, 10^8 = 1억, 10^7 = 1000만이므로 서울에서는 많은 전화번호를 할당하기 위해 두자리 지역번호를 사용하는 것이다.

* 네트워크 주소, 브로드 캐스트 주소
  * 네트워크 번호 + 호스트 번호의 조합으로 IP는 할당된다.
  * 이 때, 호스트 번호는 관리자 마음대로 할당할 수 있지만, 호스트 번호가 모두 0인수와 모두 1인수는 할당되지 않는다.
    * 0인 수는 네트워크 주소
    * 1인 수는 브로드 캐스트 주소에 할당되기 때문이다.
  * 네트워크 주소는 네트워크 자체를 가르킨다.
    * 예를 들어, 02-0000-0000 은 서울시 자체를 가르키기로 한 것과 같다.
  * 브로드 캐스트 주소는 소속된 호스트 모두를 가르킨다.